+++ 
draft = false
date = 2025-07-03
title = "Realtime data in Excel with rtd.pub"
description = "A surprising amount of the world rests on spreadsheets, yet integrating real-time data can be challenging. This post introduces rtd.pub, a platform for easily connecting any realtime data source to Microsoft Excel."
slug = "rtdpub-hello"
tags = ["data","excel","realtime","acornsoft"]
categories = []
externalLink = ""
series = []
+++

This post introduces [rtd.pub](https://rtd.pub) - a design, approach and now implementation I've been mulling over for a while. **rtd.pub is a platform for easily connecting any realtime data source to Microsoft Excel.**

This, and of course spreadsheets in general, are very boring. But they're the original low code/RAD tool: in terms of bang for buck and the power they put into the hands of domain experts, nothing comes close. (No, not some even sketchy code regurgitated by a large language model.)

I appreciate this is all quite niche, but if it saves time and makes lives easier, why not?

### Excel dev: there may be dragons

Over the years, there have been many ways of extending Excel. The original C API (ancient, fast, hard to use - if you look closely you can see evidence in the rings of the tree-of-Excel that from back when Excel was written in Pascal), COM, VBA, C# ... all on Windows, of course.

Later versions added a browser engine to Excel (Edge/Chromium on Windows, Safari on Mac) and exposed rich a JavaScript SDK. This is technically very cool and has a lot of use cases, but unfortunately is quite slow for fast moving data.

Anyway, it's a bewildering array of choices and unfamiliar territory for many developers who simply want to use their language of choice, particularly those from a non-Windows background. To the uninitiated, it might appear that developers are making heavy weather of _just_ displaying some numbers on a screen. How hard can it be?

In simple scenarios, not very hard, but to do it well, you need to figure out which approach fits best for a particular use case. This is a steep learning curve.

As we have established, for very high velocity data, the JavaScript _bridge_ is a poor choice. The trusty old `=RTD()` function that leverages COM automation is still the best choice. But then you need to understand COM, threading and ... what language to even write your COM server in. "Hey Google, what even _is_ a COM server?"

![Xander the dragon - generated by Gemini](./xander-the-dragon.jpg)

### How does rtd.pub help?

It shields developers from the above. They can write code in any language, to stream values into Excel. They can reuse code they already have. They can run complex calculations remotely on a powerful server. It is entirely open ended. All rtd.pub really does is define a protocol and provide a pipe into Excel.

### How?

So this is a design I've been thinking about for a month or two. An RTD server (written in C++) communicates with tiny processes called _plugins_ over UNIX sockets. This lightweight component runs within Excel, but by design, delegates the interesting _work to be done_ to plugins. A plugin process implements a gRPC service definition and streams protobuf messages. Plugins are started by the plugin host which supervises the process, multiplexing streams from all other plugins to efficiently pass over to Excel.

### Plugins plugins plugins

As plugins are so easy to write (usually in fewer than 100 lines of code, depending on language) it is easy to get results quickly. To move even more quickly, there is an SDK for Go (Python coming soon) that makes it very easy indeed. Finally, to move _even_ more quickly than that, NATS is supported out of the box. If you use [NATS](https://nats.io) already, you can hook your subjects up to Excel. Additional messaging systems will be added soon.

It is also simple to integrate with external vendors. For example, I wrote a plugin to the [Polygon.io stocks websocket API](https://polygon.io/docs/websocket/stocks/overview) with their [official Go client](https://github.com/polygon-io/client-go).

{{< rawhtml >}}

<div style="padding:56.25% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/1095719570?h=8f8664b780&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0" allow="autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media; web-share" style="position:absolute;top:0;left:0;width:100%;height:100%;" title="rtd.pub websocket plugin"></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>{{< /rawhtml >}}

### Commercial

Still working this out, but an indie dev needs to eat, so the plan is to [provide support, custom integrations and white label solutions for data vendors, built on rtd.pub](https://acornsoft.uk). There will be a small per-seat monthly subscription.

An ecosystem is important, so the following will be permissively open-sourced:

- The protocol / gRPC contract
- All docs SDKs and tooling
- Core plugins, such as messaging integrations such as `nats` and `kafka`, plus well-known data vendors - these can be sponsored!

### Check it out

It is not generally available yet. I'm currently building up a large suite of automated load/performance tests, but pop over to [rtd.pub](https://rtd.pub) to see it in action, and [register your interest via your GitHub account](https://rtd.pub/register.html). Give me a shout in the usual places or [email](mailto:cells@rtd.pub) if you want to arrange a demo or simply want to ask questions.
